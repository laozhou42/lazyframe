!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).lazyframe=e()}(this,(function(){"use strict";function t(){return(t=Object.assign||function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t}).apply(this,arguments)}return function(){var e,n=[],i={vendor:void 0,id:void 0,src:void 0,thumbnail:void 0,title:void 0,apikey:void 0,initialized:!1,parameters:void 0,y:void 0,debounce:250,lazyload:!0,autoplay:!0,initinview:!1,onLoad:function(t){},onAppend:function(t){},onThumbnailLoad:function(t){}},o={regex:{youtube_nocookie:/(?:youtube-nocookie\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=)))([a-zA-Z0-9_-]{6,11})/,youtube:/(?:youtube\.com\/\S*(?:(?:\/e(?:mbed))?\/|watch\?(?:\S*?&?v\=))|youtu\.be\/)([a-zA-Z0-9_-]{6,11})/,vimeo:/vimeo\.com\/(?:video\/)?([0-9]*)(?:\?|)/,vine:/vine.co\/v\/(.*)/},condition:{youtube:function(t){return!(!t||11!=t[1].length)&&t[1]},youtube_nocookie:function(t){return!(!t||11!=t[1].length)&&t[1]},vimeo:function(t){return!!(t&&9===t[1].length||8===t[1].length)&&t[1]},vine:function(t){return!(!t||11!==t[1].length)&&t[1]}},src:{youtube:function(t){return"https://www.youtube.com/embed/".concat(t.id,"/?").concat(t.parameters)},youtube_nocookie:function(t){return"https://www.youtube-nocookie.com/embed/".concat(t.id,"/?").concat(t.parameters)},vimeo:function(t){return"https://player.vimeo.com/video/".concat(t.id,"/?").concat(t.parameters)},vine:function(t){return"https://vine.co/v/".concat(t.id,"/embed/simple")}},endpoints:{youtube:function(t){return"https://www.googleapis.com/youtube/v3/videos?id=".concat(t.id,"&key=").concat(t.apikey,"&fields=items(snippet(title,thumbnails))&part=snippet")},youtube_nocookie:function(t){return"https://www.googleapis.com/youtube/v3/videos?id=".concat(t.id,"&key=").concat(t.apikey,"&fields=items(snippet(title,thumbnails))&part=snippet")},vimeo:function(t){return"https://vimeo.com/api/oembed.json?url=https%3A//vimeo.com/".concat(t.id)},vine:function(t){return"https://vine.co/oembed.json?url=https%3A%2F%2Fvine.co%2Fv%2F".concat(t.id)}},response:{youtube:{title:function(t){return t.items[0].snippet.title},thumbnail:function(t){var e=t.items[0].snippet.thumbnails;return(e.maxres||e.standard||e.high||e.medium||e.default).url}},youtube_nocookie:{title:function(t){return t.items[0].snippet.title},thumbnail:function(t){var e=t.items[0].snippet.thumbnails;return(e.maxres||e.standard||e.high||e.medium||e.default).url}},vimeo:{title:function(t){return t.title},thumbnail:function(t){return t.thumbnail_url}},vine:{title:function(t){return t.title},thumbnail:function(t){return t.thumbnail_url}}}};function r(t){var n=this;if(t instanceof HTMLElement!=!1&&!t.classList.contains("lazyframe--loaded")){var i={el:t,settings:a(t)};i.el.addEventListener("click",(function(){i.el.appendChild(i.iframe);var e=t.querySelectorAll("iframe");i.settings.onAppend.call(n,e[0])})),e.lazyload?c(i):s(i,i.settings.thumbnail)}}function a(n){var i=Array.prototype.slice.apply(n.attributes).filter((function(t){return""!==t.value})).reduce((function(t,e){return t[0===e.name.indexOf("data-")?e.name.split("data-")[1]:e.name]=e.value,t}),{}),r=t({},e,i,{y:n.offsetTop,parameters:u(i.src)});if(r.vendor){var a=r.src.match(o.regex[r.vendor]);r.id=o.condition[r.vendor](a)}return r}function u(t){var e=t.split("?");return e[1]?-1!==(e=e[1]).indexOf("autoplay")?e:e+"&autoplay=1":"autoplay=1"}function s(t){var e=this;!function(t){return!(!t.vendor||t.title&&t.thumbnail||("youtube"===t.vendor||"youtube_nocookie"===t.vendor)&&!t.apikey)}(t.settings)?c(t,!0):function(t,e){var n=o.endpoints[t.settings.vendor](t.settings),i=new XMLHttpRequest;i.open("GET",n,!0),i.onload=function(){if(i.status>=200&&i.status<400){var n=JSON.parse(i.responseText);e(null,[n,t])}else e(!0)},i.onerror=function(){e(!0)},i.send()}(t,(function(n,i){if(!n){var r=i[0],a=i[1];if(a.settings.title||(a.settings.title=o.response[a.settings.vendor].title(r)),!a.settings.thumbnail){var u=o.response[a.settings.vendor].thumbnail(r);a.settings.thumbnail=u,t.settings.onThumbnailLoad.call(e,u)}c(a,!0)}}))}function l(){var t=this,i=window.innerHeight,o=n.length,r=function(e,n){e.settings.initialized=!0,e.el.classList.add("lazyframe--loaded"),o--,s(e),e.settings.initinview&&e.el.click(),e.settings.onLoad.call(t,e)};n.filter((function(t){return t.settings.y<i})).forEach(r);var a,u,l,c,d=(a=function(){p=f<window.pageYOffset,f=window.pageYOffset,p&&n.filter((function(t){return t.settings.y<i+f&&!1===t.settings.initialized})).forEach(r),0===o&&window.removeEventListener("scroll",d,!1)},u=e.debounce,function(){var t=this,e=arguments,n=function(){c=null,l||a.apply(t,e)},i=l&&!c;clearTimeout(c),c=setTimeout(n,u),i&&a.apply(t,e)}),f=0,p=!1;window.addEventListener("scroll",d,!1)}function c(t,i){if(t.iframe=function(t){var e=document.createDocumentFragment(),n=document.createElement("iframe");t.vendor&&(t.src=o.src[t.vendor](t));n.setAttribute("id","lazyframe-".concat(t.id)),n.setAttribute("src",t.src),n.setAttribute("frameborder",0),n.setAttribute("allowfullscreen",""),t.autoplay&&(n.allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture");if("vine"===t.vendor){var i=document.createElement("script");i.setAttribute("src","https://platform.vine.co/static/scripts/embed.js"),e.appendChild(i)}return e.appendChild(n),e}(t.settings),t.settings.thumbnail&&i&&(t.el.style.backgroundImage="url(".concat(t.settings.thumbnail,")")),t.settings.title&&0===t.el.children.length){var r=document.createDocumentFragment(),a=document.createElement("span");a.className="lazyframe__title",a.innerHTML=t.settings.title,r.appendChild(a),t.el.appendChild(r)}e.lazyload||(t.el.classList.add("lazyframe--loaded"),t.settings.onLoad.call(this,t),n.push(t)),t.settings.initialized||n.push(t)}return function(n){if(e=t({},i,arguments.length<=1?void 0:arguments[1]),"string"==typeof n)for(var o=document.querySelectorAll(n),a=0;a<o.length;a++)r(o[a]);else if(void 0===n.length)r(n);else if(n.length>1)for(var u=0;u<n.length;u++)r(n[u]);else r(n[0]);e.lazyload&&l()}}()}));
//# sourceMappingURL=lazyframe.min.js.map
